<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¨ÙˆØ§Ø¨Ø© Ù†ØªØ§Ø¦Ø¬ Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø­ØµØ§ÙŠØ§</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --main: #e67e22; --bg: #fdf5e6; }
        body { font-family: 'Cairo', sans-serif; background: var(--bg); margin: 0; padding: 20px; text-align: center; }
        .card { background: white; padding: 30px; border-radius: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); max-width: 500px; margin: auto; }
        input { width: 100%; padding: 15px; margin: 10px 0; border: 1px solid #ddd; border-radius: 12px; box-sizing: border-box; text-align: center; font-size: 16px; }
        button { width: 100%; padding: 15px; background: var(--main); color: white; border: none; border-radius: 12px; font-weight: bold; cursor: pointer; margin-top: 10px; }
        .admin-zone { margin-top: 30px; border: 2px dashed #ccc; padding: 15px; border-radius: 15px; background: #fafafa; }
        table { width: 100%; margin-top: 20px; border-collapse: collapse; }
        th, td { border: 1px solid #eee; padding: 10px; text-align: center; }
        th { background: var(--main); color: white; }
    </style>
</head>
<body>

<div class="card">
    <h1 style="color: var(--main); margin-bottom: 5px;">Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø­ØµØ§ÙŠØ§ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠØ©</h1>
    <p style="color: #666;">Ø§Ø³ØªØ¹Ù„Ù… Ø¹Ù† Ù†ØªÙŠØ¬ØªÙƒ Ø¨Ø±Ù‚Ù… Ø§Ù„Ø¬Ù„ÙˆØ³</p>

    <input type="text" id="seatNum" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ø¬Ù„ÙˆØ³ ÙÙ‚Ø·">
    <button onclick="search()">Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù†ØªÙŠØ¬Ø©</button>
    <div id="result"></div>

    <div class="admin-zone">
        <p style="font-size: 12px; color: #888;">Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©: Ø§Ø±ÙØ¹ÙŠ Ù…Ù„Ù Ø¹Ø§Ø¯Ù„.xlsx Ù‡Ù†Ø§ ğŸ‘‡</p>
        <input type="file" id="uploadFile" accept=".xlsx, .xls" style="font-size: 11px;">
        <p id="status" style="font-size: 12px; color: green;"></p>
    </div>
</div>

<script>
    let db = [];

    // 1. Ø§Ù„Ù…Ø­Ø±Ùƒ Ø§Ù„Ù„ÙŠ Ø¨ÙŠÙÙ‡Ù… Ø£ÙŠ Ù…Ù„Ù Ø¥ÙƒØ³ÙŠÙ„ ØªØ±ÙØ¹ÙŠÙ‡
    document.getElementById('uploadFile').addEventListener('change', function(e) {
        const file = e.target.files[0];
        const reader = new FileReader();
        
        reader.onload = function(event) {
            const data = new Uint8Array(event.target.result);
            const workbook = XLSX.read(data, {type: 'array'});
            const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
            // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¥ÙƒØ³ÙŠÙ„ Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨ÙŠÙÙ‡Ù…Ù‡Ø§ Ø§Ù„Ù…ÙˆÙ‚Ø¹
            db = XLSX.utils.sheet_to_json(firstSheet);
            document.getElementById('status').innerText = "âœ… ØªÙ… Ø±Ø¨Ø· Ø§Ù„Ù…Ù„Ù Ø¨Ù†Ø¬Ø§Ø­! Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¨Ø­Ø«.";
        };
        reader.readAsArrayBuffer(file);
    });

    // 2. ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø¨Ø­Ø« Ø¨Ø±Ù‚Ù… Ø§Ù„Ø¬Ù„ÙˆØ³
    function search() {
        const code = document.getElementById('seatNum').value.trim();
        const output = document.getElementById('result');

        if (db.length === 0) {
            output.innerHTML = "<p style='color:red'>Ø¨Ø±Ø¬Ø§Ø¡ Ø±ÙØ¹ Ù…Ù„Ù Ø§Ù„Ø¥ÙƒØ³ÙŠÙ„ Ø£ÙˆÙ„Ø§Ù‹ Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©!</p>";
            return;
        }

        // Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù‡ÙŠØ¯ÙˆØ± ÙÙŠ Ø¹Ù…ÙˆØ¯ "Ø±Ù‚Ù… Ø§Ù„Ø¬Ù„ÙˆØ³" (ØªØ£ÙƒØ¯ÙŠ Ø¥Ù† Ø¯Ù‡ Ø§Ø³Ù…Ù‡ ÙÙŠ Ù…Ù„ÙÙƒ)
        const student = db.find(s => String(s["Ø±Ù‚Ù… Ø§Ù„Ø¬Ù„ÙˆØ³"]) === code || String(s["Ø±Ù‚Ù…_Ø§Ù„Ø¬Ù„ÙˆØ³"]) === code);

        if (student) {
            let resHtml = `<div style="margin-top:20px; text-align:right;">
                <b>Ø§Ù„Ø§Ø³Ù…: ${student["Ø§Ù„Ø§Ø³Ù…"] || "ØºÙŠØ± Ù…Ø³Ø¬Ù„"}</b>
                <table><tr><th>Ø§Ù„Ù…Ø§Ø¯Ø©</th><th>Ø§Ù„Ø¯Ø±Ø¬Ø©</th></tr>`;
            
            for (let key in student) {
                if (key !== "Ø§Ù„Ø§Ø³Ù…" && key !== "Ø±Ù‚Ù… Ø§Ù„Ø¬Ù„ÙˆØ³" && key !== "Ø±Ù‚Ù…_Ø§Ù„Ø¬Ù„ÙˆØ³") {
                    resHtml += `<tr><td>${key}</td><td>${student[key]}</td></tr>`;
                }
            }
            resHtml += `</table></div>`;
            output.innerHTML = resHtml;
        } else {
            output.innerHTML = "<p style='color:red'>Ø±Ù‚Ù… Ø§Ù„Ø¬Ù„ÙˆØ³ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„Ù…Ù„Ù!</p>";
        }
    }
</script>

</body>
</html>
