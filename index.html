Ù¡<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†ØªØ§Ø¦Ø¬ Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø­ØµØ§ÙŠØ§ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠØ©</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #d35400; --secondary: #2c3e50; --bg: #f4f7f6; }
        body { font-family: 'Cairo', sans-serif; background: var(--bg); margin: 0; display: flex; align-items: center; justify-content: center; min-height: 100vh; }
        .container { background: white; width: 90%; max-width: 500px; padding: 40px; border-radius: 30px; box-shadow: 0 20px 50px rgba(0,0,0,0.1); text-align: center; border-top: 8px solid var(--primary); }
        h1 { color: var(--secondary); font-weight: 900; margin-bottom: 5px; font-size: 26px; }
        p { color: #7f8c8d; margin-bottom: 30px; }
        input { width: 100%; padding: 15px; border: 2px solid #eee; border-radius: 15px; font-size: 18px; text-align: center; font-family: 'Cairo'; transition: 0.3s; box-sizing: border-box; margin-bottom: 20px; }
        input:focus { border-color: var(--primary); outline: none; box-shadow: 0 0 10px rgba(211, 84, 0, 0.1); }
        button { width: 100%; padding: 15px; background: var(--primary); color: white; border: none; border-radius: 15px; font-size: 18px; font-weight: 700; cursor: pointer; transition: 0.3s; }
        button:hover { background: var(--secondary); transform: translateY(-2px); }
        .result-card { margin-top: 30px; padding: 20px; background: #fff; border-radius: 20px; border: 1px solid #eee; box-shadow: 0 10px 20px rgba(0,0,0,0.05); text-align: right; display: none; animation: fadeIn 0.5s ease; }
        table { width: 100%; margin-top: 15px; border-collapse: collapse; }
        th, td { padding: 12px; border-bottom: 1px solid #f1f1f1; text-align: center; }
        th { color: var(--primary); font-weight: 700; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="container">
    <h1>Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø­ØµØ§ÙŠØ§ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠØ© Ø§Ù„Ù…Ø´ØªØ±ÙƒØ©</h1>
    <p>Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø¹Ù† Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø·Ù„Ø§Ø¨ ğŸ“</p>

    <input type="number" id="seatNumber" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ø¬Ù„ÙˆØ³">
    <button onclick="searchResult()">Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø¢Ù†</button>

    <div id="resultCard" class="result-card">
        <div id="studentInfo"></div>
        <table>
            <thead><tr><th>Ø§Ù„Ù…Ø§Ø¯Ø©</th><th>Ø§Ù„Ø¯Ø±Ø¬Ø©</th></tr></thead>
            <tbody id="gradesBody"></tbody>
        </table>
        <button onclick="window.print()" style="background:#7f8c8d; margin-top:15px; font-size:14px;">Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© ğŸ–¨ï¸</button>
    </div>
    <div id="errorMsg" style="color: red; margin-top: 20px; display: none;">Ø±Ù‚Ù… Ø§Ù„Ø¬Ù„ÙˆØ³ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ Ø£Ùˆ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø§ ØªØ²Ø§Ù„ ØªØ­Ù…Ù„!</div>
</div>

<script>
    // Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨ØªØ§Ø¹Ùƒ Ø§Ù„Ù„ÙŠ Ø¨Ø¹ØªÙŠÙ‡
    const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQGvEe5NpeC3FhY1bx-CjEHTLx_Au7wEZaGlyozvNIJwtTzEuxmlM8sFBFgYP2dhA/pub?output=csv";

    let studentsData = [];

    async function loadData() {
        try {
            const response = await fetch(sheetUrl);
            const text = await response.text();
            const rows = text.split('\n').map(row => row.split(','));
            const headers = rows[0].map(h => h.trim());

            studentsData = rows.slice(1).map(row => {
                let obj = {};
                headers.forEach((header, i) => {
                    obj[header] = row[i] ? row[i].trim() : "";
                });
                return obj;
            });
            console.log("Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¬Ø§Ù‡Ø²Ø©");
        } catch (e) {
            console.error("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„");
        }
    }

    loadData();

    function searchResult() {
        const seat = document.getElementById('seatNumber').value.trim();
        const card = document.getElementById('resultCard');
        const error = document.getElementById('errorMsg');
        const info = document.getElementById('studentInfo');
        const body = document.getElementById('gradesBody');

        // Ø§Ù„Ø¨Ø­Ø« Ø¨Ø±Ù‚Ù… Ø§Ù„Ø¬Ù„ÙˆØ³ (ØªØ£ÙƒØ¯ÙŠ Ø¥Ù† Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙˆØ¯ ÙÙŠ Ù…Ù„Ù Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ Ù‡Ùˆ "Ø±Ù‚Ù… Ø§Ù„Ø¬Ù„ÙˆØ³")
        const student = studentsData.find(s => s["Ø±Ù‚Ù… Ø§Ù„Ø¬Ù„ÙˆØ³"] === seat);

        if (student) {
            error.style.display = 'none';
            card.style.display = 'block';
            info.innerHTML = `<h3 style="color:var(--secondary); margin:0;">Ø§Ù„Ø§Ø³Ù…: ${student["Ø§Ù„Ø§Ø³Ù…"]}</h3>`;
            
            let rows = "";
            for (let key in student) {
                // Ø§Ù„ÙƒÙˆØ¯ Ù‡ÙŠØ¹Ø±Ø¶ Ø£ÙŠ Ø­Ø§Ø¬Ø© ØºÙŠØ± Ø§Ù„Ø§Ø³Ù… ÙˆØ±Ù‚Ù… Ø§Ù„Ø¬Ù„ÙˆØ³ ÙƒØ£Ù†Ù‡Ø§ Ø¯Ø±Ø¬Ø§Øª Ù…ÙˆØ§Ø¯
                if (key !== "Ø§Ù„Ø§Ø³Ù…" && key !== "Ø±Ù‚Ù… Ø§Ù„Ø¬Ù„ÙˆØ³" && student[key] !== "") {
                    rows += `<tr><td>${key}</td><td><b>${student[key]}</b></td></tr>`;
                }
            }
            body.innerHTML = rows;
        } else {
            card.style.display = 'none';
            error.style.display = 'block';
        }
    }
</script>

</body>
</html>
